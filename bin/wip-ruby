#!/usr/bin/env ruby

# puts "wip-ruby..."
# puts "    args... #{ARGV.inspect}"

BASH_COMMANDS = [:show]

begin
  require 'wip'
rescue LoadError
  $:.unshift(File.expand_path('../../lib', __FILE__))
  require 'wip'
end

require 'wip/cli'

begin
  result = WIP::CLI::Shell.start

  if result && BASH_COMMANDS.include?(ARGV.first.intern)
    STDOUT.print result
  end
rescue WIP::WIPError => e
  WIP.ui.error e.message
  WIP.ui.error e.backtrace.join("\n") if ENV["WIP_DEBUG"]
  exit e.status_code
rescue Interrupt
  WIP.ui.error "\nQuitting..."
  exit 1
end
